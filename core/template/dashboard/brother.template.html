<div class="eqLogic eqLogic-widget #eqType# allowResize" style="width:#width#;height:#height#;#style#" data-eqLogic_id="#id#" data-eqLogic_uid="#uid#" data-version="#version#" data-eqType="#eqType#" data-translate-category="#translate_category#" data-category="#category#" data-tags="#tags#" >
  <center class="widget-name">
    <span class="warning" title="#alert_name#"><i class='#alert_icon#'></i></span>
    <span class="cmd refresh pull-right cursor" data-cmd_id="#refresh_id#"><i class="fas fa-sync"></i></span>
    <span class="reportModeVisible">#name_display# <span class="object_name">#object_name#</span></span>
    <a href="#eqLink#" class="reportModeHidden">#name_display# <span class="object_name">#object_name#</span></a>
  </center>
  <div>
    <div style="width: 50%; display:inline-block;">
      <center>
        <figure style="width: 150px;margin-left: 5px;margin-top: 5px;margin-bottom: 5px;margin-right: 5px;">
          <div id="gauge-container-#id#"></div>
        </figure>
      </center>
    </div>
    <div style="width: 50%; float: right;">
      <center>
        <div class="cmd cmd-widget" data-type="info" data-subtype="numeric" data-template="line" data-cmd_id="#brother_status_id#" title="Date de valeur : #brother_status_valueDate#<br/>Date de collecte : #brother_status_collectDate#">
          <div class="content-xs">
            <span class="cmdName ">Status </span> <strong class="state">#brother_status#</strong>
          </div>
        </div>
        <br/>
        <div class="cmd cmd-widget history cursor" data-type="info" data-subtype="numeric" data-template="tile" data-cmd_id="#brother_counter_id#" title="Date de valeur : #brother_counter_valueDate#<br/>Date de collecte : #brother_counter_collectDate#">
          <div class="title ">
            <div class="cmdName">Pages</div>
          </div>
          <div class="content-sm">
            <span class="pull-right"></span>
            <span class="pull-right state">#brother_counter#</span>
          </div>
        </div>
        <br/>
        <div class="cmd cmd-widget history cursor" data-type="info" data-subtype="numeric" data-template="tile" data-cmd_id="#brother_lastprints_id#" title="Date de valeur : #brother_lastprints_valueDate#<br/>Date de collecte : #brother_lastprints_collectDate#">
          <div class="title ">
            <div class="cmdName">Derni√®res impressions</div>
          </div>
          <div class="content-sm">
            <span class="pull-right"></span>
            <span class="pull-right state">#brother_lastprints#</span>
          </div>
        </div>
      </center>
    </div>
  </div>
  #divGraphInfo#
  <script>
    // Remove all unused cmd (empty id)
    $('.eqLogic[data-eqLogic_uid=#uid#] [data-cmd_id=""]').remove();

    // Enable manual refresh
    if ('#refresh_id#' != '') {
      $('.cmd[data-cmd_id=#refresh_id#]').off('click').on('click', function () {
        jeedom.cmd.execute({id: '#refresh_id#'});
      });
    }

    // Draw graph
    Highcharts.chart('gauge-container-#id#', {
      credits: {enabled: false},
      exporting : {enabled: false},
      title: {text: null},
      tooltip: {enabled: false},

      chart: {
        type: 'solidgauge',
        backgroundColor: 'transaprent',
        height: '100%'
      },

      pane: {
        startAngle: 0,
        endAngle: 360,
        background: [
        { // Track for Black
          outerRadius: '99%',
          innerRadius: '84%',
          backgroundColor: 'rgba(204,204,204,#black_bkg#)',
          borderWidth: 0
        }, { // Track for Cyan
          outerRadius: '83%',
          innerRadius: '68%',
          backgroundColor: 'rgba(204,204,204,#cyan_bkg#)',
          borderWidth: 0
        }, { // Track for Magenta
          outerRadius: '67%',
          innerRadius: '52%',
          backgroundColor: 'rgba(204,204,204,#magenta_bkg#)',
          borderWidth: 0
        }, { // Track for Yellow
          outerRadius: '51%',
          innerRadius: '36%',
          backgroundColor: 'rgba(204,204,204,#yellow_bkg#)',
          borderWidth: 0
        }]
      },

      yAxis: {
        min: 0,
        max: 100,
        lineWidth: 0,
        tickPositions: []
      },

      plotOptions: {
        solidgauge: {
          dataLabels: {
            enabled: false
          },
          linecap: 'round',
          stickyTracking: false,
          rounded: true,
          cursor: 'pointer',
          point: {
            events: {
              click: function () {
                $('#md_modal2').dialog({title: "{{Historique}}"}).load('index.php?v=d&modal=cmd.history&id=' + this.options.key).dialog('open')
              }
            }
          }
        }
      },

      series: [{
        name: 'Black',
        data: [{
          color: 'rgba(0,0,0,#black_visible#)',
          radius: '99%',
          innerRadius: '84%',
          y: #black_level#,
          key: '#black_id#'
        }]
      }, {
        name: 'Cyan',
        data: [{
          color: 'rgba(0,255,255,#cyan_visible#)',
          radius: '83%',
          innerRadius: '68%',
          y: #cyan_level#,
          key: '#cyan_id#'
        }]
      }, {
        name: 'Magenta',
        data: [{
          color: 'rgba(255,0,255,#magenta_visible#)',
          radius: '67%',
          innerRadius: '52%',
          y: #magenta_level#,
          key: '#magenta_id#'
        }]
      }, {
        name: 'Yellow',
        data: [{
          color: 'rgba(255,255,0,#yellow_visible#)',
          radius: '51%',
          innerRadius: '36%',
          y: #yellow_level#,
          key: '#yellow_id#'
        }]
      }]
    });

    // Update Status on value change
    jeedom.cmd.addUpdateFunction('#brother_status_id#',function(_options) {
      $('.cmd[data-cmd_id=#brother_status_id#]').attr('title', ' : '+_options.valueDate+'<br/> : '+_options.collectDate)
      $('.cmd[data-cmd_id=#brother_status_id#] .state').empty().append(_options.display_value)
    });

    // Update Counter on value change
    jeedom.cmd.addUpdateFunction('#brother_counter_id#',function(_options) {
      $('.cmd[data-cmd_id=#brother_counter_id#]').attr('title', ' : '+_options.valueDate+'<br/> : '+_options.collectDate)
      $('.cmd[data-cmd_id=#brother_counter_id#] .state').empty().append(_options.display_value)
    });

    // Update Lastprints on value change
    jeedom.cmd.addUpdateFunction('#brother_lastprints_id#',function(_options) {
      $('.cmd[data-cmd_id=#brother_lastprints_id#]').attr('title', ' : '+_options.valueDate+'<br/> : '+_options.collectDate)
      $('.cmd[data-cmd_id=#brother_lastprints_id#] .state').empty().append(_options.display_value)
    });

    // Update Black on graph on value change
    jeedom.cmd.addUpdateFunction('#black_id#',function(_options) {
      $('#gauge-container-#id#').highcharts().series[0].update({data: [{y: _options.value}]});
    });

    // Update Cyan on graph on value change
    jeedom.cmd.addUpdateFunction('#cyan_id#',function(_options) {
      $('#gauge-container-#id#').highcharts().series[1].update({data: [{y: _options.value}]});
    });

    // Update Magenta on graph on value change
    jeedom.cmd.addUpdateFunction('#magenta_id#',function(_options) {
      $('#gauge-container-#id#').highcharts().series[2].update({data: [{y: _options.value}]});
    });

    // Update Yellow on graph on value change
    jeedom.cmd.addUpdateFunction('#yellow_id#',function(_options) {
      $('#gauge-container-#id#').highcharts().series[3].update({data: [{y: _options.value}]});
    });

  </script>
</div>
